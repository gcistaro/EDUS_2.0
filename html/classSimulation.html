<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>My Project: Simulation Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">My Project
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-attribs">Public Attributes</a> &#124;
<a href="#friends">Friends</a> &#124;
<a href="classSimulation-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">Simulation Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>This class contains all the variables that are used in the simulations.  
 <a href="classSimulation.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="Simulation_8hpp_source.html">Simulation.hpp</a>&gt;</code></p>
<div class="dynheader">
Collaboration diagram for Simulation:</div>
<div class="dyncontent">
<div class="center"><img src="classSimulation__coll__graph.png" border="0" usemap="#Simulation_coll__map" alt="Collaboration graph"/></div>
<map name="Simulation_coll__map" id="Simulation_coll__map">
<area shape="rect" title="This class contains all the variables that are used in the simulations." alt="" coords="5,95,97,121"/>
<area shape="rect" href="classCoulomb.html" title="Class that takes care of the calculation of the effective Hamiltonian during time propagation,..." alt="" coords="11,5,91,32"/>
</map>
<center><span class="legend">[<a href="graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a5b224cc5b36bcc8eb29689aff223de41"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSimulation.html#a5b224cc5b36bcc8eb29689aff223de41">Simulation</a> ()</td></tr>
<tr class="separator:a5b224cc5b36bcc8eb29689aff223de41"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2964c7449ba626fede54f171a0d07275"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSimulation.html#a2964c7449ba626fede54f171a0d07275">Simulation</a> (std::shared_ptr&lt; Simulation_parameters &gt; &amp;ctx__)</td></tr>
<tr class="memdesc:a2964c7449ba626fede54f171a0d07275"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialization of all the variables needed for the simulation, as well as allocation of memory and definition of the differential equations.  <a href="classSimulation.html#a2964c7449ba626fede54f171a0d07275">More...</a><br /></td></tr>
<tr class="separator:a2964c7449ba626fede54f171a0d07275"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a63e0db5f8d71f776f56d9b357db10dc7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSimulation.html#a63e0db5f8d71f776f56d9b357db10dc7">SettingUp_EigenSystem</a> ()</td></tr>
<tr class="memdesc:a63e0db5f8d71f776f56d9b357db10dc7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Driver for the diagonalization of the Hamiltonian. Here we already know the k grid on which we want to propagate our system, defined in the density matrix. With that and H0(k) already set up in the material class (material_.H), we are able to diagonalize and getting eigenvalues (Band_energies_) and eigenvectors (Uk) that will be used later. <br  />
  <a href="classSimulation.html#a63e0db5f8d71f776f56d9b357db10dc7">More...</a><br /></td></tr>
<tr class="separator:a63e0db5f8d71f776f56d9b357db10dc7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1e055dd58b94b2abb4f74978400b2295"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSimulation.html#a1e055dd58b94b2abb4f74978400b2295">print_grids</a> ()</td></tr>
<tr class="memdesc:a1e055dd58b94b2abb4f74978400b2295"><td class="mdescLeft">&#160;</td><td class="mdescRight">(For debugging and currently not used) print grids of the simulation.  <a href="classSimulation.html#a1e055dd58b94b2abb4f74978400b2295">More...</a><br /></td></tr>
<tr class="separator:a1e055dd58b94b2abb4f74978400b2295"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a15feeafc4fb78b2660e9e6faa1215034"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSimulation.html#a15feeafc4fb78b2660e9e6faa1215034">Calculate_TDHamiltonian</a> (const double &amp;time__, const bool &amp;erase_H__)</td></tr>
<tr class="memdesc:a15feeafc4fb78b2660e9e6faa1215034"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to calculate the time dependent Hamiltonian (one-body) as a sum of H0 and the interaction with the laser:  <a href="classSimulation.html#a15feeafc4fb78b2660e9e6faa1215034">More...</a><br /></td></tr>
<tr class="separator:a15feeafc4fb78b2660e9e6faa1215034"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5d2c0dfb2782baab484e636eb216dada"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSimulation.html#a5d2c0dfb2782baab484e636eb216dada">Calculate_Velocity</a> ()</td></tr>
<tr class="memdesc:a5d2c0dfb2782baab484e636eb216dada"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculation of the matrix elements of the velocity operator on the basis in k. As the density matrix is propagated in wannier gauge, this is the gauge where we calculate it. The equation implemented here is: \( \textbf{v}_{nm}(\textbf{k}) = -i[\textbf{X}(\textbf{k}), H_0(\textbf{k})] + \nabla_{\textbf{k}} H_0(\textbf{k}) \) or, in R space: \( \textbf{v}_{nm}(\textbf{R}) = -i[\textbf{r}, H_0(\textbf{k})] + i \textbf{R} H_0(\textbf{k}) \).  <a href="classSimulation.html#a5d2c0dfb2782baab484e636eb216dada">More...</a><br /></td></tr>
<tr class="separator:a5d2c0dfb2782baab484e636eb216dada"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afba18f70cf7cc1103f6e38d6ec6be243"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSimulation.html#afba18f70cf7cc1103f6e38d6ec6be243">Propagate</a> ()</td></tr>
<tr class="memdesc:afba18f70cf7cc1103f6e38d6ec6be243"><td class="mdescLeft">&#160;</td><td class="mdescRight">Driver for the full time propagation. It prints every 100 steps in the standard output a message.  <a href="classSimulation.html#afba18f70cf7cc1103f6e38d6ec6be243">More...</a><br /></td></tr>
<tr class="separator:afba18f70cf7cc1103f6e38d6ec6be243"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a689dbd13ddf9bdd7736f948c53ccb241"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSimulation.html#a689dbd13ddf9bdd7736f948c53ccb241">do_onestep</a> ()</td></tr>
<tr class="memdesc:a689dbd13ddf9bdd7736f948c53ccb241"><td class="mdescLeft">&#160;</td><td class="mdescRight">Driver for single time step propagation.  <a href="classSimulation.html#a689dbd13ddf9bdd7736f948c53ccb241">More...</a><br /></td></tr>
<tr class="separator:a689dbd13ddf9bdd7736f948c53ccb241"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a887515981cb00ee66f5a9631fcaa59d4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSimulation.html#a887515981cb00ee66f5a9631fcaa59d4">print_recap</a> ()</td></tr>
<tr class="memdesc:a887515981cb00ee66f5a9631fcaa59d4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Recap of all the variables of the simulation, as read from the input json file or got from default values.  <a href="classSimulation.html#a887515981cb00ee66f5a9631fcaa59d4">More...</a><br /></td></tr>
<tr class="separator:a887515981cb00ee66f5a9631fcaa59d4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adab5dcd46de8e853ea60dac94d9eb211"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSimulation.html#adab5dcd46de8e853ea60dac94d9eb211">PrintObservables</a> (const double &amp;time__, const bool &amp;use_sparse=true)</td></tr>
<tr class="memdesc:adab5dcd46de8e853ea60dac94d9eb211"><td class="mdescLeft">&#160;</td><td class="mdescRight">Defines whether or not at the current time step time__ we print the txt files and the matrices in hdf5.  <a href="classSimulation.html#adab5dcd46de8e853ea60dac94d9eb211">More...</a><br /></td></tr>
<tr class="separator:adab5dcd46de8e853ea60dac94d9eb211"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af15fac6567371d9562af8e148d1a3018"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSimulation.html#af15fac6567371d9562af8e148d1a3018">Print_Population</a> ()</td></tr>
<tr class="memdesc:af15fac6567371d9562af8e148d1a3018"><td class="mdescLeft">&#160;</td><td class="mdescRight">Prints in Population.txt the Population for each band:  <a href="classSimulation.html#af15fac6567371d9562af8e148d1a3018">More...</a><br /></td></tr>
<tr class="separator:af15fac6567371d9562af8e148d1a3018"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5b4e4f0f2036ae9e18db78b1bb3697de"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSimulation.html#a5b4e4f0f2036ae9e18db78b1bb3697de">Print_Velocity</a> ()</td></tr>
<tr class="memdesc:a5b4e4f0f2036ae9e18db78b1bb3697de"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the mean value of the velocity operator and prints it in Output/Velocity.txt. The equation implemented is: \textbf{v}(t) = \text{Tr}(\rho \textbf{v}) where v are the matrix elements of the velocity operator in the basis. Everything is conveniently done in k space.  <a href="classSimulation.html#a5b4e4f0f2036ae9e18db78b1bb3697de">More...</a><br /></td></tr>
<tr class="separator:a5b4e4f0f2036ae9e18db78b1bb3697de"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ade0bd87a9390b31c84b14352ecf597ec"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSimulation.html#ade0bd87a9390b31c84b14352ecf597ec">get_it</a> (const double &amp;time__) const</td></tr>
<tr class="separator:ade0bd87a9390b31c84b14352ecf597ec"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a31ac3d6ce374600c311b4fecd751f645"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSimulation.html#a31ac3d6ce374600c311b4fecd751f645">get_it_sparse</a> (const double &amp;time__) const</td></tr>
<tr class="memdesc:a31ac3d6ce374600c311b4fecd751f645"><td class="mdescLeft">&#160;</td><td class="mdescRight">(WARNING: this function could be unsafe in the future). Get a (unique) index for the creation of a node in the h5 file for the current time step.  <a href="classSimulation.html#a31ac3d6ce374600c311b4fecd751f645">More...</a><br /></td></tr>
<tr class="separator:a31ac3d6ce374600c311b4fecd751f645"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a607e503c2ec40914c90024736708ce46"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSimulation.html#a607e503c2ec40914c90024736708ce46">jacobian</a> (const Matrix&lt; double &gt; &amp;A__) const</td></tr>
<tr class="memdesc:a607e503c2ec40914c90024736708ce46"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculation of the jacobian of the real lattice vectors.  <a href="classSimulation.html#a607e503c2ec40914c90024736708ce46">More...</a><br /></td></tr>
<tr class="separator:a607e503c2ec40914c90024736708ce46"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a47b848c0698dddb77de2d81ba2c6de82"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSimulation.html#a47b848c0698dddb77de2d81ba2c6de82">wavelength_or_frequency</a> (const int &amp;)</td></tr>
<tr class="memdesc:a47b848c0698dddb77de2d81ba2c6de82"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check what is defined in the json file: frequency or wavelength. What is not defined has the value 0.  <a href="classSimulation.html#a47b848c0698dddb77de2d81ba2c6de82">More...</a><br /></td></tr>
<tr class="separator:a47b848c0698dddb77de2d81ba2c6de82"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-attribs"></a>
Public Attributes</h2></td></tr>
<tr class="memitem:a5b3283db5383ccd453a5a9271599c0b2"><td class="memItemLeft" align="right" valign="top">Material&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSimulation.html#a5b3283db5383ccd453a5a9271599c0b2">material_</a></td></tr>
<tr class="memdesc:a5b3283db5383ccd453a5a9271599c0b2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Object containing the main operators for the simulation (H0 and r)  <a href="classSimulation.html#a5b3283db5383ccd453a5a9271599c0b2">More...</a><br /></td></tr>
<tr class="separator:a5b3283db5383ccd453a5a9271599c0b2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0b20ffe41299460cb1c47e932d999499"><td class="memItemLeft" align="right" valign="top">std::shared_ptr&lt; Simulation_parameters &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSimulation.html#a0b20ffe41299460cb1c47e932d999499">ctx_</a></td></tr>
<tr class="separator:a0b20ffe41299460cb1c47e932d999499"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ada98b8acc7ea24584cd79166a3609a30"><td class="memItemLeft" align="right" valign="top">Operator&lt; std::complex&lt; double &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSimulation.html#ada98b8acc7ea24584cd79166a3609a30">H_</a></td></tr>
<tr class="separator:ada98b8acc7ea24584cd79166a3609a30"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5fdfd4a3a5d0bbbb9eef3de04182a8bb"><td class="memItemLeft" align="right" valign="top">std::array&lt; Operator&lt; std::complex&lt; double &gt; &gt;, 3 &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSimulation.html#a5fdfd4a3a5d0bbbb9eef3de04182a8bb">Velocity_</a></td></tr>
<tr class="separator:a5fdfd4a3a5d0bbbb9eef3de04182a8bb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6a59e1656df49d80e2aebcbb1be084d6"><td class="memItemLeft" align="right" valign="top">std::vector&lt; mdarray&lt; double, 1 &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSimulation.html#a6a59e1656df49d80e2aebcbb1be084d6">Band_energies_</a></td></tr>
<tr class="memdesc:a6a59e1656df49d80e2aebcbb1be084d6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Eigenvalues of the Hamiltonian, grouped like: Band_energies[ik](ibnd)  <a href="classSimulation.html#a6a59e1656df49d80e2aebcbb1be084d6">More...</a><br /></td></tr>
<tr class="separator:a6a59e1656df49d80e2aebcbb1be084d6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aee17af4d296a8d64d2427b8aa5b1a4f8"><td class="memItemLeft" align="right" valign="top">SetOfLaser&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSimulation.html#aee17af4d296a8d64d2427b8aa5b1a4f8">setoflaser_</a></td></tr>
<tr class="memdesc:aee17af4d296a8d64d2427b8aa5b1a4f8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Total laser acting on the system, as a sum over the single lasers.  <a href="classSimulation.html#aee17af4d296a8d64d2427b8aa5b1a4f8">More...</a><br /></td></tr>
<tr class="separator:aee17af4d296a8d64d2427b8aa5b1a4f8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9b18af6a257e191f88e2b15ab284bb95"><td class="memItemLeft" align="right" valign="top">Operator&lt; std::complex&lt; double &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSimulation.html#a9b18af6a257e191f88e2b15ab284bb95">DensityMatrix_</a></td></tr>
<tr class="memdesc:a9b18af6a257e191f88e2b15ab284bb95"><td class="mdescLeft">&#160;</td><td class="mdescRight">What we are propagating in time.  <a href="classSimulation.html#a9b18af6a257e191f88e2b15ab284bb95">More...</a><br /></td></tr>
<tr class="separator:a9b18af6a257e191f88e2b15ab284bb95"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0da9083170b770224e86250bd8fadfb1"><td class="memItemLeft" align="right" valign="top">DESolver&lt; Operator&lt; std::complex&lt; double &gt; &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSimulation.html#a0da9083170b770224e86250bd8fadfb1">DEsolver_DM_</a></td></tr>
<tr class="separator:a0da9083170b770224e86250bd8fadfb1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0154a90a65dfab9ce5982f9a19c90d46"><td class="memItemLeft" align="right" valign="top">kGradient&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSimulation.html#a0154a90a65dfab9ce5982f9a19c90d46">kgradient_</a></td></tr>
<tr class="memdesc:a0154a90a65dfab9ce5982f9a19c90d46"><td class="mdescLeft">&#160;</td><td class="mdescRight">Object to deal with the gradient term. More details in the class.  <a href="classSimulation.html#a0154a90a65dfab9ce5982f9a19c90d46">More...</a><br /></td></tr>
<tr class="separator:a0154a90a65dfab9ce5982f9a19c90d46"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2a4571c38c533eb2e8cee96f2f313327"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classCoulomb.html">Coulomb</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSimulation.html#a2a4571c38c533eb2e8cee96f2f313327">coulomb_</a></td></tr>
<tr class="memdesc:a2a4571c38c533eb2e8cee96f2f313327"><td class="mdescLeft">&#160;</td><td class="mdescRight">Object to calculate the <a class="el" href="classCoulomb.html" title="Class that takes care of the calculation of the effective Hamiltonian during time propagation,...">Coulomb</a> effective Hamiltonian. More details in the class.  <a href="classSimulation.html#a2a4571c38c533eb2e8cee96f2f313327">More...</a><br /></td></tr>
<tr class="separator:a2a4571c38c533eb2e8cee96f2f313327"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a81bf83b45cdceccd9df413a582a2b0d2"><td class="memItemLeft" align="right" valign="top">Space&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSimulation.html#a81bf83b45cdceccd9df413a582a2b0d2">SpaceOfPropagation_</a> = k</td></tr>
<tr class="memdesc:a81bf83b45cdceccd9df413a582a2b0d2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Space where we calculate the commutator \( [H, \rho] \).  <a href="classSimulation.html#a81bf83b45cdceccd9df413a582a2b0d2">More...</a><br /></td></tr>
<tr class="separator:a81bf83b45cdceccd9df413a582a2b0d2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9dcfcc33fc916846369f766949e7c04d"><td class="memItemLeft" align="right" valign="top">Space&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSimulation.html#a9dcfcc33fc916846369f766949e7c04d">SpaceOfPropagation_Gradient_</a> = R</td></tr>
<tr class="memdesc:a9dcfcc33fc916846369f766949e7c04d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Space where we calculate the gradient in k.  <a href="classSimulation.html#a9dcfcc33fc916846369f766949e7c04d">More...</a><br /></td></tr>
<tr class="separator:a9dcfcc33fc916846369f766949e7c04d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af032ed737948c692f8d23cd45af817d3"><td class="memItemLeft" align="right" valign="top">std::ofstream&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSimulation.html#af032ed737948c692f8d23cd45af817d3">os_Time_</a></td></tr>
<tr class="memdesc:af032ed737948c692f8d23cd45af817d3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Output text file to print the time values where we get the other text files printed.  <a href="classSimulation.html#af032ed737948c692f8d23cd45af817d3">More...</a><br /></td></tr>
<tr class="separator:af032ed737948c692f8d23cd45af817d3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afc6831715f34f8d725fdde2f49ab8106"><td class="memItemLeft" align="right" valign="top">std::ofstream&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSimulation.html#afc6831715f34f8d725fdde2f49ab8106">os_Laser_</a></td></tr>
<tr class="memdesc:afc6831715f34f8d725fdde2f49ab8106"><td class="mdescLeft">&#160;</td><td class="mdescRight">Output text file to print the laser in time, electric field <br  />
  <a href="classSimulation.html#afc6831715f34f8d725fdde2f49ab8106">More...</a><br /></td></tr>
<tr class="separator:afc6831715f34f8d725fdde2f49ab8106"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af72309fa66deb401060530b8f8efdc0f"><td class="memItemLeft" align="right" valign="top">std::ofstream&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSimulation.html#af72309fa66deb401060530b8f8efdc0f">os_VectorPot_</a></td></tr>
<tr class="memdesc:af72309fa66deb401060530b8f8efdc0f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Output text file to print the laser in time, vector potential.  <a href="classSimulation.html#af72309fa66deb401060530b8f8efdc0f">More...</a><br /></td></tr>
<tr class="separator:af72309fa66deb401060530b8f8efdc0f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4b922c86df51460e8516531fe3aa9145"><td class="memItemLeft" align="right" valign="top">std::ofstream&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSimulation.html#a4b922c86df51460e8516531fe3aa9145">os_Pop_</a></td></tr>
<tr class="memdesc:a4b922c86df51460e8516531fe3aa9145"><td class="mdescLeft">&#160;</td><td class="mdescRight">Output text file to print the population in time (in bloch gauge) as a sum over all the k points.  <a href="classSimulation.html#a4b922c86df51460e8516531fe3aa9145">More...</a><br /></td></tr>
<tr class="separator:a4b922c86df51460e8516531fe3aa9145"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a836ae9b47a085522e76ad0b8fe8b3725"><td class="memItemLeft" align="right" valign="top">std::ofstream&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSimulation.html#a836ae9b47a085522e76ad0b8fe8b3725">os_Velocity_</a></td></tr>
<tr class="memdesc:a836ae9b47a085522e76ad0b8fe8b3725"><td class="mdescLeft">&#160;</td><td class="mdescRight">Output text file to print the mean value of the velocity operator over the state where our system is at time t.  <a href="classSimulation.html#a836ae9b47a085522e76ad0b8fe8b3725">More...</a><br /></td></tr>
<tr class="separator:a836ae9b47a085522e76ad0b8fe8b3725"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="friends"></a>
Friends</h2></td></tr>
<tr class="memitem:a6ab19bad74c92af3e28f6416f0cff8e8"><td class="memTemplParams" colspan="2">template&lt;typename Scalar_T &gt; </td></tr>
<tr class="memitem:a6ab19bad74c92af3e28f6416f0cff8e8"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="classSimulation.html#a6ab19bad74c92af3e28f6416f0cff8e8">SumWithProduct</a> (Operator&lt; std::complex&lt; double &gt;&gt; &amp;Output__, const Scalar_T &amp;FirstScalar__, const Operator&lt; std::complex&lt; double &gt;&gt; &amp;FirstAddend__, const Scalar_T &amp;SecondScalar__, const Operator&lt; std::complex&lt; double &gt;&gt; &amp;SecondAddend__)</td></tr>
<tr class="separator:a6ab19bad74c92af3e28f6416f0cff8e8"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>This class contains all the variables that are used in the simulations. </p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a5b224cc5b36bcc8eb29689aff223de41"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5b224cc5b36bcc8eb29689aff223de41">&#9670;&nbsp;</a></span>Simulation() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Simulation::Simulation </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a2964c7449ba626fede54f171a0d07275"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2964c7449ba626fede54f171a0d07275">&#9670;&nbsp;</a></span>Simulation() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Simulation::Simulation </td>
          <td>(</td>
          <td class="paramtype">std::shared_ptr&lt; Simulation_parameters &gt; &amp;&#160;</td>
          <td class="paramname"><em>ctx__</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialization of all the variables needed for the simulation, as well as allocation of memory and definition of the differential equations. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx__</td><td><a class="el" href="classSimulation.html" title="This class contains all the variables that are used in the simulations.">Simulation</a> parameters already set up and ready to initialize everything in the simulation class </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a15feeafc4fb78b2660e9e6faa1215034"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a15feeafc4fb78b2660e9e6faa1215034">&#9670;&nbsp;</a></span>Calculate_TDHamiltonian()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Simulation::Calculate_TDHamiltonian </td>
          <td>(</td>
          <td class="paramtype">const double &amp;&#160;</td>
          <td class="paramname"><em>time__</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool &amp;&#160;</td>
          <td class="paramname"><em>erase_H__</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Function to calculate the time dependent Hamiltonian (one-body) as a sum of H0 and the interaction with the laser: </p>
<p class="formulaDsp">
\[ H_{\text{1B}}(\textbf{k}) = H_0(\textbf{k})+ \boldsymbol{\varepsilon}(t)\cdot \Xi(\textbf{k}) \]
</p>
 <dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">time__</td><td>Time on which we want to calculate the hamiltonian, used for the laser </td></tr>
    <tr><td class="paramname">erase_H__</td><td>If true, we delete H_ before computing it. Needs to be false during time propagation to sum up contributions </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a5d2c0dfb2782baab484e636eb216dada"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5d2c0dfb2782baab484e636eb216dada">&#9670;&nbsp;</a></span>Calculate_Velocity()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Simulation::Calculate_Velocity </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculation of the matrix elements of the velocity operator on the basis in k. As the density matrix is propagated in wannier gauge, this is the gauge where we calculate it. The equation implemented here is: \( \textbf{v}_{nm}(\textbf{k}) = -i[\textbf{X}(\textbf{k}), H_0(\textbf{k})] + \nabla_{\textbf{k}} H_0(\textbf{k}) \) or, in R space: \( \textbf{v}_{nm}(\textbf{R}) = -i[\textbf{r}, H_0(\textbf{k})] + i \textbf{R} H_0(\textbf{k}) \). </p>

</div>
</div>
<a id="a689dbd13ddf9bdd7736f948c53ccb241"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a689dbd13ddf9bdd7736f948c53ccb241">&#9670;&nbsp;</a></span>do_onestep()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Simulation::do_onestep </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Driver for single time step propagation. </p>
<ul>
<li>checks if something needs to be printed using PrintObservables</li>
<li>prints .txt file and/or h5</li>
<li>Triggers the one step propagation in DEsolver </li>
</ul>

</div>
</div>
<a id="ade0bd87a9390b31c84b14352ecf597ec"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ade0bd87a9390b31c84b14352ecf597ec">&#9670;&nbsp;</a></span>get_it()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int Simulation::get_it </td>
          <td>(</td>
          <td class="paramtype">const double &amp;&#160;</td>
          <td class="paramname"><em>time__</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a31ac3d6ce374600c311b4fecd751f645"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a31ac3d6ce374600c311b4fecd751f645">&#9670;&nbsp;</a></span>get_it_sparse()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int Simulation::get_it_sparse </td>
          <td>(</td>
          <td class="paramtype">const double &amp;&#160;</td>
          <td class="paramname"><em>time__</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>(WARNING: this function could be unsafe in the future). Get a (unique) index for the creation of a node in the h5 file for the current time step. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">time__</td><td>Time at which we are printing the h5 files </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Index corresponding to time__ in h5 files </dd></dl>

</div>
</div>
<a id="a607e503c2ec40914c90024736708ce46"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a607e503c2ec40914c90024736708ce46">&#9670;&nbsp;</a></span>jacobian()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double Simulation::jacobian </td>
          <td>(</td>
          <td class="paramtype">const Matrix&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>A__</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculation of the jacobian of the real lattice vectors. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">A__</td><td>Matrix containing the real lattice vectors spanned over the columns </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The jacobian of the matrix. Notice that A__ is always 3x3 while we calculate the jacobian using the submatrix when we have a slab material. In that case only the submatrix 2x2 is used. </dd></dl>

</div>
</div>
<a id="a1e055dd58b94b2abb4f74978400b2295"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1e055dd58b94b2abb4f74978400b2295">&#9670;&nbsp;</a></span>print_grids()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Simulation::print_grids </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>(For debugging and currently not used) print grids of the simulation. </p>

</div>
</div>
<a id="af15fac6567371d9562af8e148d1a3018"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af15fac6567371d9562af8e148d1a3018">&#9670;&nbsp;</a></span>Print_Population()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Simulation::Print_Population </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Prints in Population.txt the Population for each band: </p>
<p class="formulaDsp">
\[ P_n(t) = \frac{1}{N}\sum_{\textbf{k}} \rho_{nn}(\textbf{k}) where @f$ \rho_{nn}(\textbf{k}) @f$ is the density matrix in the bloch gauge. \]
</p>
 
</div>
</div>
<a id="a887515981cb00ee66f5a9631fcaa59d4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a887515981cb00ee66f5a9631fcaa59d4">&#9670;&nbsp;</a></span>print_recap()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Simulation::print_recap </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Recap of all the variables of the simulation, as read from the input json file or got from default values. </p>

</div>
</div>
<a id="a5b4e4f0f2036ae9e18db78b1bb3697de"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5b4e4f0f2036ae9e18db78b1bb3697de">&#9670;&nbsp;</a></span>Print_Velocity()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Simulation::Print_Velocity </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates the mean value of the velocity operator and prints it in Output/Velocity.txt. The equation implemented is: \textbf{v}(t) = \text{Tr}(\rho \textbf{v}) where v are the matrix elements of the velocity operator in the basis. Everything is conveniently done in k space. </p>

</div>
</div>
<a id="adab5dcd46de8e853ea60dac94d9eb211"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adab5dcd46de8e853ea60dac94d9eb211">&#9670;&nbsp;</a></span>PrintObservables()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool Simulation::PrintObservables </td>
          <td>(</td>
          <td class="paramtype">const double &amp;&#160;</td>
          <td class="paramname"><em>time__</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool &amp;&#160;</td>
          <td class="paramname"><em>use_sparse</em> = <code>true</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Defines whether or not at the current time step time__ we print the txt files and the matrices in hdf5. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">time__</td><td>Current time in the simulation </td></tr>
    <tr><td class="paramname">use_sparse</td><td>If true, we never use the sparse printing, mainly needed for the printing of big matrices when laser is off </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Boolean defining if we want to print the observables </dd></dl>

</div>
</div>
<a id="afba18f70cf7cc1103f6e38d6ec6be243"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afba18f70cf7cc1103f6e38d6ec6be243">&#9670;&nbsp;</a></span>Propagate()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Simulation::Propagate </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Driver for the full time propagation. It prints every 100 steps in the standard output a message. </p>

</div>
</div>
<a id="a63e0db5f8d71f776f56d9b357db10dc7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a63e0db5f8d71f776f56d9b357db10dc7">&#9670;&nbsp;</a></span>SettingUp_EigenSystem()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Simulation::SettingUp_EigenSystem </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Driver for the diagonalization of the Hamiltonian. Here we already know the k grid on which we want to propagate our system, defined in the density matrix. With that and H0(k) already set up in the material class (material_.H), we are able to diagonalize and getting eigenvalues (Band_energies_) and eigenvectors (Uk) that will be used later. <br  />
 </p>

</div>
</div>
<a id="a47b848c0698dddb77de2d81ba2c6de82"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a47b848c0698dddb77de2d81ba2c6de82">&#9670;&nbsp;</a></span>wavelength_or_frequency()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::string Simulation::wavelength_or_frequency </td>
          <td>(</td>
          <td class="paramtype">const int &amp;&#160;</td>
          <td class="paramname"><em>idx__</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Check what is defined in the json file: frequency or wavelength. What is not defined has the value 0. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">idx__</td><td>Index of the laser for which we are checking if is defined with frequency or with wavelength </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>"wavelength" or "frequency", depending which one defines the laser. </dd></dl>

</div>
</div>
<h2 class="groupheader">Friends And Related Function Documentation</h2>
<a id="a6ab19bad74c92af3e28f6416f0cff8e8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6ab19bad74c92af3e28f6416f0cff8e8">&#9670;&nbsp;</a></span>SumWithProduct</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename Scalar_T &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SumWithProduct </td>
          <td>(</td>
          <td class="paramtype">Operator&lt; std::complex&lt; double &gt;&gt; &amp;&#160;</td>
          <td class="paramname"><em>Output__</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Scalar_T &amp;&#160;</td>
          <td class="paramname"><em>FirstScalar__</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Operator&lt; std::complex&lt; double &gt;&gt; &amp;&#160;</td>
          <td class="paramname"><em>FirstAddend__</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Scalar_T &amp;&#160;</td>
          <td class="paramname"><em>SecondScalar__</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Operator&lt; std::complex&lt; double &gt;&gt; &amp;&#160;</td>
          <td class="paramname"><em>SecondAddend__</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">friend</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="a6a59e1656df49d80e2aebcbb1be084d6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6a59e1656df49d80e2aebcbb1be084d6">&#9670;&nbsp;</a></span>Band_energies_</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;mdarray&lt;double,1&gt; &gt; Simulation::Band_energies_</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Eigenvalues of the Hamiltonian, grouped like: Band_energies[ik](ibnd) </p>

</div>
</div>
<a id="a2a4571c38c533eb2e8cee96f2f313327"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2a4571c38c533eb2e8cee96f2f313327">&#9670;&nbsp;</a></span>coulomb_</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classCoulomb.html">Coulomb</a> Simulation::coulomb_</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Object to calculate the <a class="el" href="classCoulomb.html" title="Class that takes care of the calculation of the effective Hamiltonian during time propagation,...">Coulomb</a> effective Hamiltonian. More details in the class. </p>

</div>
</div>
<a id="a0b20ffe41299460cb1c47e932d999499"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0b20ffe41299460cb1c47e932d999499">&#9670;&nbsp;</a></span>ctx_</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::shared_ptr&lt;Simulation_parameters&gt; Simulation::ctx_</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Object containing all the parameters that needs to be set; they get read or simply they get some default values </p>

</div>
</div>
<a id="a9b18af6a257e191f88e2b15ab284bb95"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9b18af6a257e191f88e2b15ab284bb95">&#9670;&nbsp;</a></span>DensityMatrix_</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Operator&lt;std::complex&lt;double&gt; &gt; Simulation::DensityMatrix_</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>What we are propagating in time. </p>

</div>
</div>
<a id="a0da9083170b770224e86250bd8fadfb1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0da9083170b770224e86250bd8fadfb1">&#9670;&nbsp;</a></span>DEsolver_DM_</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">DESolver&lt;Operator&lt;std::complex&lt;double&gt; &gt; &gt; Simulation::DEsolver_DM_</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Driver for the time propagation, it defines how we solve the differential equations and it is fed with our equation </p>

</div>
</div>
<a id="ada98b8acc7ea24584cd79166a3609a30"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ada98b8acc7ea24584cd79166a3609a30">&#9670;&nbsp;</a></span>H_</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Operator&lt;std::complex&lt;double&gt; &gt; Simulation::H_</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Full Hamiltonian: \( H_ = H0 + H_{\text{eff}} +E(t)\cdot \Xi \), while the term with the gradient is treated separately </p>

</div>
</div>
<a id="a0154a90a65dfab9ce5982f9a19c90d46"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0154a90a65dfab9ce5982f9a19c90d46">&#9670;&nbsp;</a></span>kgradient_</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">kGradient Simulation::kgradient_</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Object to deal with the gradient term. More details in the class. </p>

</div>
</div>
<a id="a5b3283db5383ccd453a5a9271599c0b2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5b3283db5383ccd453a5a9271599c0b2">&#9670;&nbsp;</a></span>material_</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Material Simulation::material_</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Object containing the main operators for the simulation (H0 and r) </p>

</div>
</div>
<a id="afc6831715f34f8d725fdde2f49ab8106"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afc6831715f34f8d725fdde2f49ab8106">&#9670;&nbsp;</a></span>os_Laser_</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::ofstream Simulation::os_Laser_</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Output text file to print the laser in time, electric field <br  />
 </p>

</div>
</div>
<a id="a4b922c86df51460e8516531fe3aa9145"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4b922c86df51460e8516531fe3aa9145">&#9670;&nbsp;</a></span>os_Pop_</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::ofstream Simulation::os_Pop_</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Output text file to print the population in time (in bloch gauge) as a sum over all the k points. </p>

</div>
</div>
<a id="af032ed737948c692f8d23cd45af817d3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af032ed737948c692f8d23cd45af817d3">&#9670;&nbsp;</a></span>os_Time_</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::ofstream Simulation::os_Time_</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Output text file to print the time values where we get the other text files printed. </p>

</div>
</div>
<a id="af72309fa66deb401060530b8f8efdc0f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af72309fa66deb401060530b8f8efdc0f">&#9670;&nbsp;</a></span>os_VectorPot_</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::ofstream Simulation::os_VectorPot_</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Output text file to print the laser in time, vector potential. </p>

</div>
</div>
<a id="a836ae9b47a085522e76ad0b8fe8b3725"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a836ae9b47a085522e76ad0b8fe8b3725">&#9670;&nbsp;</a></span>os_Velocity_</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::ofstream Simulation::os_Velocity_</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Output text file to print the mean value of the velocity operator over the state where our system is at time t. </p>

</div>
</div>
<a id="aee17af4d296a8d64d2427b8aa5b1a4f8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aee17af4d296a8d64d2427b8aa5b1a4f8">&#9670;&nbsp;</a></span>setoflaser_</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SetOfLaser Simulation::setoflaser_</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Total laser acting on the system, as a sum over the single lasers. </p>

</div>
</div>
<a id="a81bf83b45cdceccd9df413a582a2b0d2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a81bf83b45cdceccd9df413a582a2b0d2">&#9670;&nbsp;</a></span>SpaceOfPropagation_</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Space Simulation::SpaceOfPropagation_ = k</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Space where we calculate the commutator \( [H, \rho] \). </p>

</div>
</div>
<a id="a9dcfcc33fc916846369f766949e7c04d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9dcfcc33fc916846369f766949e7c04d">&#9670;&nbsp;</a></span>SpaceOfPropagation_Gradient_</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Space Simulation::SpaceOfPropagation_Gradient_ = R</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Space where we calculate the gradient in k. </p>

</div>
</div>
<a id="a5fdfd4a3a5d0bbbb9eef3de04182a8bb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5fdfd4a3a5d0bbbb9eef3de04182a8bb">&#9670;&nbsp;</a></span>Velocity_</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::array&lt;Operator&lt;std::complex&lt;double&gt; &gt;, 3&gt; Simulation::Velocity_</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This is defined as \( V_{nm}(\textbf{k}) = \langle n\textbf{k}| v |m\textbf{k} \rangle \) or, in real space, \( V_{nm(\textbf{R})} = \langle n\textbf{0} | v | m\textbf{R}\rangle \) </p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>src/Simulation/<a class="el" href="Simulation_8hpp_source.html">Simulation.hpp</a></li>
<li>src/Simulation/<a class="el" href="Simulation_8cpp.html">Simulation.cpp</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
